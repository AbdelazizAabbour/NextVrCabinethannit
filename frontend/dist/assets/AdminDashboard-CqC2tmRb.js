import{u as S,r as i,j as e}from"./index-BoFExgq-.js";import{g as _,b as M,d as R,e as B,f as D,u as E,h as W}from"./api-oSc_hS0v.js";const T=()=>{const o=S(),[a,l]=i.useState("appointments"),[r,p]=i.useState({total_rdv:0,pending_rdv:0,today_rdv:0,unread_messages:0}),[g,x]=i.useState([]),[N,k]=i.useState([]),[b,j]=i.useState([]),[f,y]=i.useState([]),[d,h]=i.useState("all"),[I,m]=i.useState(!0);i.useEffect(()=>{if(!localStorage.getItem("admin_token")){o("/admin/login");return}u();const t=setInterval(u,45e3);return()=>clearInterval(t)},[o]);const u=async()=>{m(!0);try{const[s,t,n,c,A]=await Promise.all([_(),M(),R(),B(),D()]);p(s.data),x(t.data),k(n.data),j(c.data),y(A.data)}catch(s){console.error("Error fetching dashboard data:",s)}finally{m(!1)}},v=async(s,t)=>{try{await E(s,t),x(n=>n.map(c=>c.id===s?{...c,status:t}:c))}catch(n){console.error("Error updating status:",n)}},w=async s=>{try{await W(s,!0),j(t=>t.map(n=>n.id===s?{...n,is_read:!0}:n))}catch(t){console.error("Error marking as read:",t)}},L=()=>{localStorage.removeItem("admin_token"),o("/admin/login")},C=g.filter(s=>d==="all"?!0:s.status===d);return e.jsxs("div",{className:"admin-dashboard",children:[e.jsxs("div",{className:"admin-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"Cabinet Hannit"}),e.jsx("span",{children:"Administration"})]}),e.jsxs("nav",{className:"sidebar-nav",children:[e.jsxs("button",{className:`nav-item ${a==="appointments"?"active":""}`,onClick:()=>l("appointments"),children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Rendez-vous"]}),e.jsxs("button",{className:`nav-item ${a==="patients"?"active":""}`,onClick:()=>l("patients"),children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"Patients"]}),e.jsxs("button",{className:`nav-item ${a==="messages"?"active":""}`,onClick:()=>l("messages"),children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),e.jsx("polyline",{points:"22,6 12,13 2,6"})]}),"Messages",r.unread_messages>0&&e.jsx("span",{className:"unread-count",children:r.unread_messages})]}),e.jsxs("button",{className:`nav-item ${a==="users"?"active":""}`,onClick:()=>l("users"),children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("polyline",{points:"17 11 19 13 23 9"})]}),"Utilisateurs"]})]}),e.jsx("div",{className:"sidebar-footer",children:e.jsxs("button",{onClick:L,className:"logout-btn",children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Déconnexion"]})})]}),e.jsxs("main",{className:"admin-content",children:[e.jsxs("header",{className:"content-header",children:[e.jsx("h1",{className:"page-title",children:"Tableau de Bord"}),e.jsxs("div",{className:"user-profile",children:[e.jsx("div",{className:"avatar",children:"A"}),e.jsx("span",{children:"Asmaâ Hannit"})]})]}),e.jsxs("div",{className:"stats-cards",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon primary",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("h3",{children:r.total_rdv}),e.jsx("p",{children:"Total Rendez-vous"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon warning",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("h3",{children:r.pending_rdv}),e.jsx("p",{children:"En Attente"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon success",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("h3",{children:r.today_rdv}),e.jsx("p",{children:"Aujourd'hui"})]})]})]}),a==="appointments"&&e.jsxs("div",{className:"dashboard-card main-table animate-fadeInUp",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h2",{children:"Rendez-vous Récents"}),e.jsxs("div",{className:"filter-tabs",children:[e.jsx("button",{className:d==="all"?"active":"",onClick:()=>h("all"),children:"Tous"}),e.jsx("button",{className:d==="pending"?"active":"",onClick:()=>h("pending"),children:"En Attente"}),e.jsx("button",{className:d==="confirmed"?"active":"",onClick:()=>h("confirmed"),children:"Confirmés"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Patient"}),e.jsx("th",{children:"Service"}),e.jsx("th",{children:"Date & Heure"}),e.jsx("th",{children:"Téléphone"}),e.jsx("th",{children:"Statut"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:C.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.service}),e.jsx("td",{children:e.jsxs("div",{className:"datetime",children:[e.jsx("span",{className:"date",children:s.date}),e.jsx("span",{className:"time",children:s.time})]})}),e.jsx("td",{children:s.phone}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.status}`,children:s.status==="pending"?"En Attente":s.status==="confirmed"?"Confirmé":"Annulé"})}),e.jsx("td",{children:e.jsx("div",{className:"actions",children:s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"action-btn check",onClick:()=>v(s.id,"confirmed"),title:"Confirmer",children:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}),e.jsx("button",{className:"action-btn cross",onClick:()=>v(s.id,"cancelled"),title:"Annuler",children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})})})]},s.id))})]})})]}),a==="patients"&&e.jsxs("div",{className:"dashboard-card animate-fadeInUp",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h2",{children:"Liste des Patients"}),e.jsx("input",{type:"text",placeholder:"Rechercher...",className:"search-input",style:{padding:"6px 12px",borderRadius:"4px",border:"1px solid #ddd"}})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nom"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Téléphone"}),e.jsx("th",{children:"Dernière Visite"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:N.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.email||"N/A"}),e.jsx("td",{children:s.phone}),e.jsx("td",{children:"---"}),e.jsx("td",{children:e.jsx("button",{className:"action-btn view",title:"Voir dossier",children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]},s.id))})]})})]}),a==="messages"&&e.jsxs("div",{className:"dashboard-card animate-fadeInUp",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{children:"Messages Reçus"})}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"De"}),e.jsx("th",{children:"Sujet"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"État"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:b.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.subject}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{children:s.is_read?e.jsx("span",{className:"status-badge confirmed",children:"Lu"}):e.jsx("span",{className:"status-badge pending",children:"Non lu"})}),e.jsx("td",{children:!s.is_read&&e.jsx("button",{className:"action-btn view",onClick:()=>w(s.id),title:"Marquer comme lu",children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),e.jsx("polyline",{points:"22,6 12,13 2,6"})]})})})]},s.id))})]})})]}),a==="users"&&e.jsxs("div",{className:"dashboard-card animate-fadeInUp",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{children:"Utilisateurs Enregistrés"})}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nom"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Rôle"}),e.jsx("th",{children:"Inscrit le"})]})}),e.jsx("tbody",{children:f.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.email}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.is_admin?"confirmed":"pending"}`,children:s.is_admin?"Administrateur":"Utilisateur"})}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()})]},s.id))})]})})]})]})]})};export{T as default};
