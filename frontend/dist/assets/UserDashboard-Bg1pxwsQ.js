import{r as d,u as w,j as e,L as a}from"./index-BoFExgq-.js";import{i as b,t as k}from"./api-oSc_hS0v.js";const D=()=>{const[x,m]=d.useState(null),[N,p]=d.useState(!0),[v,g]=d.useState(null),[c,i]=d.useState("overview"),j=w();if(d.useEffect(()=>{const s=async()=>{try{const n=await b();m(n.data)}catch(n){console.error("Error fetching dashboard data:",n);const y=n.response?.data?.error||n.response?.data?.message||"";g("Impossible de charger les données du tableau de bord. "+y),n.response&&n.response.status===401&&j("/connexion")}finally{p(!1)}};s();const h=setInterval(s,3e4);return()=>clearInterval(h)},[j]),N)return e.jsx("div",{className:"user-dashboard",children:e.jsxs("div",{className:"dashboard-container",style:{textAlign:"center",padding:"100px 0"},children:[e.jsx("div",{className:"spinner",style:{margin:"0 auto 20px"}}),e.jsx("p",{children:"Chargement de votre espace personnel..."})]})});if(v)return e.jsx("div",{className:"user-dashboard",children:e.jsx("div",{className:"dashboard-container",children:e.jsxs("div",{className:"card",style:{textAlign:"center",borderTop:"4px solid var(--primary)",padding:"40px"},children:[e.jsx("h2",{style:{color:"var(--primary)",marginBottom:"20px"},children:"Oups !"}),e.jsx("div",{className:"error-box",style:{background:"#fff1f2",color:"#be123c",padding:"15px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #fda4af"},children:v}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Réessayer"})]})})});if(!x)return null;const{user:l,appointments:t,messages:r,selections:u,stats:o}=x,f=()=>{switch(c){case"appointments":return e.jsx("div",{className:"data-table-container",children:t.length>0?e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Service"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Heure"}),e.jsx("th",{children:"Statut"})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.service||"N/A"}),e.jsx("td",{children:new Date(s.date).toLocaleDateString("fr-FR")}),e.jsx("td",{children:s.time||"--:--"}),e.jsx("td",{children:e.jsx("span",{className:`status-badge status-${s.status}`,children:s.status==="pending"?"En attente":s.status==="confirmed"?"Confirmé":s.status==="cancelled"?"Annulé":s.status})})]},s.id))})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("h4",{children:"Aucun rendez-vous trouvé"}),e.jsx(a,{to:"/rendez-vous",className:"btn btn-primary",children:"Prendre rendez-vous"})]})});case"messages":return e.jsx("div",{className:"data-table-container",children:r.length>0?e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Sujet"}),e.jsx("th",{children:"Message"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Statut"})]})}),e.jsx("tbody",{children:r.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:s.subject}),e.jsx("td",{style:{maxWidth:"300px"},className:"text-truncate",children:s.message}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString("fr-FR")}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.is_read?"status-confirmed":"status-pending"}`,children:s.is_read?"Lu":"Non lu"})})]},s.id))})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("h4",{children:"Aucun message envoyé"}),e.jsx(a,{to:"/contact",className:"btn btn-primary",children:"Nous contacter"})]})});case"selections":return e.jsx("div",{className:"selections-grid",children:u.length>0?u.map(s=>e.jsxs("div",{className:"selection-card",children:[e.jsx("h4",{children:s.title}),e.jsx("p",{children:s.description}),e.jsxs("div",{className:"card-actions",children:[e.jsx(a,{to:"/services",className:"btn-text",children:"Détails"}),e.jsx("button",{onClick:async()=>{await k(s.id);const h=await b();m(h.data)},className:"btn btn-secondary btn-sm",children:"Retirer"})]})]},s.id)):e.jsxs("div",{className:"empty-state",style:{gridColumn:"1 / -1"},children:[e.jsx("h4",{children:"Vous n'avez pas encore de services sélectionnés"}),e.jsx(a,{to:"/services",className:"btn btn-primary",children:"Explorer les services"})]})});default:return e.jsxs("div",{className:"overview-content",children:[e.jsxs("div",{className:"welcome-section",children:[e.jsxs("h3",{children:["Bienvenue sur votre espace, ",l.name," !"]}),e.jsx("p",{children:"Retrouvez ici l'historique de vos rendez-vous, vos messages et vos services préférés."})]}),e.jsxs("div",{className:"overview-grid",children:[e.jsxs("div",{className:"overview-card",children:[e.jsxs("div",{className:"overview-card-header",children:[e.jsx("h4",{children:"Prochain Rendez-vous"}),e.jsx(a,{to:"#",onClick:()=>i("appointments"),className:"view-all",children:"Tout voir"})]}),e.jsx("div",{className:"overview-card-body",children:t.length>0?e.jsxs("div",{className:"featured-item",children:[e.jsx("div",{className:"item-main",children:t[0].service}),e.jsxs("div",{className:"item-sub",children:[new Date(t[0].date).toLocaleDateString("fr-FR")," à ",t[0].time]}),e.jsx("span",{className:`status-badge status-${t[0].status}`,children:t[0].status==="pending"?"En attente":"Confirmé"})]}):e.jsx("p",{className:"empty-text",children:"Aucun rendez-vous à venir."})})]}),e.jsxs("div",{className:"overview-card",children:[e.jsxs("div",{className:"overview-card-header",children:[e.jsx("h4",{children:"Dernier Message"}),e.jsx(a,{to:"#",onClick:()=>i("messages"),className:"view-all",children:"Tout voir"})]}),e.jsx("div",{className:"overview-card-body",children:r.length>0?e.jsxs("div",{className:"featured-item",children:[e.jsx("div",{className:"item-main",children:r[0].subject}),e.jsx("div",{className:"item-sub text-truncate",style:{maxWidth:"200px"},children:r[0].message}),e.jsx("div",{className:"item-date",children:new Date(r[0].created_at).toLocaleDateString("fr-FR")})]}):e.jsx("p",{className:"empty-text",children:"Aucun message envoyé."})})]})]}),e.jsxs("div",{className:"quick-actions-bar",children:[e.jsx("h4",{children:"Actions Rapides"}),e.jsxs("div",{className:"action-buttons",children:[e.jsx(a,{to:"/rendez-vous",className:"btn btn-primary btn-sm",children:"Nouveau Rendez-vous"}),e.jsx(a,{to:"/services",className:"btn btn-secondary btn-sm",children:"Explorer les Services"}),e.jsx(a,{to:"/contact",className:"btn btn-white btn-sm",children:"Nous Contacter"})]})]})]})}};return e.jsx("div",{className:"user-dashboard animate-fadeInUp",children:e.jsxs("div",{className:"dashboard-container",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Mon Tableau de Bord"}),e.jsxs("p",{children:["Espace patient de ",l.name]})]}),e.jsx("div",{className:"user-profile-summary",children:l.auth_provider==="google"&&e.jsxs("div",{className:"google-badge-dashboard",children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",style:{marginRight:"8px"},children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Authentifié avec Google"]})})]}),e.jsxs("div",{className:"dashboard-stats",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon icon-blue",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("h3",{children:"Rendez-vous"}),e.jsx("div",{className:"stat-value",children:o.total_appointments})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon icon-green",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("h3",{children:"Messages"}),e.jsx("div",{className:"stat-value",children:o.total_messages})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon icon-purple",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("h3",{children:"Sélections"}),e.jsx("div",{className:"stat-value",children:o.total_selections})]})]})]}),e.jsxs("div",{className:"dashboard-tabs",children:[e.jsx("button",{className:`tab-btn ${c==="overview"?"active":""}`,onClick:()=>i("overview"),children:"Aperçu"}),e.jsx("button",{className:`tab-btn ${c==="appointments"?"active":""}`,onClick:()=>i("appointments"),children:"Mes Rendez-vous"}),e.jsx("button",{className:`tab-btn ${c==="messages"?"active":""}`,onClick:()=>i("messages"),children:"Mes Messages"}),e.jsx("button",{className:`tab-btn ${c==="selections"?"active":""}`,onClick:()=>i("selections"),children:"Mes Sélections"})]}),e.jsx("div",{className:"tab-content animate-fadeInUp",children:f()})]})})};export{D as default};
